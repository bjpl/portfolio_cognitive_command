<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Portfolio Cognitive Command v8.0 Dashboard</title>
    <script crossorigin src="https://unpkg.com/react@18/umd/react.production.min.js"></script>
    <script crossorigin src="https://unpkg.com/react-dom@18/umd/react-dom.production.min.js"></script>
    <script src="https://unpkg.com/@babel/standalone/babel.min.js"></script>
    <script src="https://cdn.tailwindcss.com"></script>
    <script src="https://unpkg.com/recharts@2.5.0/dist/Recharts.js"></script>
    <style>
        .flip-card {
            perspective: 1000px;
        }
        .flip-card-inner {
            position: relative;
            width: 100%;
            height: 100%;
            transition: transform 0.6s;
            transform-style: preserve-3d;
        }
        .flip-card:hover .flip-card-inner {
            transform: rotateY(180deg);
        }
        .flip-card-front, .flip-card-back {
            position: absolute;
            width: 100%;
            height: 100%;
            backface-visibility: hidden;
            border-radius: 0.5rem;
        }
        .flip-card-back {
            transform: rotateY(180deg);
        }
        .heatmap-node {
            transition: all 0.3s ease;
        }
        .heatmap-node:hover {
            transform: scale(1.3);
            z-index: 10;
        }
    </style>
</head>
<body class="bg-slate-900 text-slate-100">
    <div id="root"></div>

    <script type="text/babel">
        const { useState, useEffect } = React;

        // Icons (using Unicode since Lucide needs proper setup)
        const RobotIcon = () => <span className="text-lg">ü§ñ</span>;
        const UserIcon = () => <span className="text-lg">üë§</span>;
        const AlertIcon = () => <span className="text-lg">‚ö†Ô∏è</span>;
        const CheckIcon = () => <span className="text-lg">‚úì</span>;
        const TrendingUpIcon = () => <span className="text-lg">üìà</span>;
        const GitBranchIcon = () => <span className="text-lg">üîÄ</span>;

        // DYNAMICALLY LOADED DATA FROM SHARDS - Generated 2025-12-11
        // This data is auto-generated from output/docs/shards/*.json
        const initialData = {
            meta: {
                precision: 85,
                active: 8,
                dormant: 29,
                total: 37,
                lastScan: new Date().toISOString()
            },
            scanDate: new Date().toISOString().split('T')[0],
            projects: [
                // ===== ACTIVE PROJECTS (8) =====
                {
                    id: "aves",
                    name: "aves",
                    status: "green",
                    score: 92,
                    cluster: "Core Systems",
                    source: "robot",
                    metrics: { commits: 13, tests: 27, coverage: 0 },
                    lastCommit: "2025-12-10",
                    techStack: ["Node.js", "Express", "Railway"],
                    nextAction: "Monitor production deployment health",
                    reasoning: "Railway backend API with ReinforcementLearningEngine. Fixed categorization logic and test assertions. All 27 RL tests passing. Production-ready with CORS and health check configuration."
                },
                {
                    id: "california_puzzle_game",
                    name: "california_puzzle_game",
                    status: "green",
                    score: 95,
                    cluster: "Experience",
                    source: "robot",
                    metrics: { commits: 22, tests: 0, coverage: 0 },
                    lastCommit: "2025-12-10",
                    techStack: ["React", "Zustand", "TypeScript"],
                    nextAction: "Add more geography content",
                    reasoning: "Interactive geography game with modern state management. Migrated from localStorage to Zustand, fixed React hooks linting. CI/CD pipeline passing."
                },
                {
                    id: "colombia_puzzle_game",
                    name: "colombia_puzzle_game",
                    status: "green",
                    score: 95,
                    cluster: "Experience",
                    source: "robot",
                    metrics: { commits: 23, tests: 344, coverage: 0 },
                    lastCommit: "2025-12-10",
                    techStack: ["React", "Vitest", "TypeScript"],
                    nextAction: "Expand test coverage for touch interactions",
                    reasoning: "Colombia geography game with comprehensive test suite. 344 tests passing. Fixed focus trap and touch interaction tests. Build successful."
                },
                {
                    id: "describe_it",
                    name: "describe_it",
                    status: "green",
                    score: 95,
                    cluster: "Experience",
                    source: "robot",
                    metrics: { commits: 10, tests: 0, coverage: 0 },
                    lastCommit: "2025-12-10",
                    techStack: ["Next.js", "TypeScript", "Unsplash API"],
                    nextAction: "Add more language support",
                    reasoning: "Image description app with consolidated API key management. Removed duplicate modals, added Language tab. Single settings location for all API keys."
                },
                {
                    id: "espanso_agentic_studio",
                    name: "espanso_agentic_studio",
                    status: "green",
                    score: 95,
                    cluster: "Infra",
                    source: "robot",
                    metrics: { commits: 7, tests: 1274, coverage: 82 },
                    lastCommit: "2025-12-09",
                    techStack: ["Python", "Observable", "IPC", "GOAP"],
                    nextAction: "Continue test coverage expansion",
                    reasoning: "Espanso text expansion with agent orchestration. 1274 tests (+173). Fixed Observable thread-safety, IPC client disconnect. Production readiness 8.2/10."
                },
                {
                    id: "hablas",
                    name: "hablas",
                    status: "green",
                    score: 95,
                    cluster: "Experience",
                    source: "robot",
                    metrics: { commits: 16, tests: 0, coverage: 0 },
                    lastCommit: "2025-12-10",
                    techStack: ["Next.js", "TypeScript", "Vercel"],
                    nextAction: "Deploy to production",
                    reasoning: "Spanish language learning platform. Fixed TypeScript build errors for Vercel deployment. Added proper type interfaces and error handling."
                },
                {
                    id: "learn_comptia_network+",
                    name: "learn_comptia_network+",
                    status: "green",
                    score: 95,
                    cluster: "Experience",
                    source: "robot",
                    metrics: { commits: 12, tests: 0, coverage: 0 },
                    lastCommit: "2025-12-10",
                    techStack: ["React", "Static Deploy", "Mock API"],
                    nextAction: "Add more certification content",
                    reasoning: "CompTIA Network+ study app. Fixed mock API for static deployments. shouldUseMockAPI() now properly handles DISABLE_NETWORK_CALLS flag."
                },
                {
                    id: "portfolio_cognitive_command",
                    name: "portfolio_cognitive_command",
                    status: "green",
                    score: 93,
                    cluster: "Core Systems",
                    source: "robot",
                    metrics: { commits: 6, tests: 797, coverage: 93 },
                    lastCommit: "2025-12-10",
                    techStack: ["TypeScript", "AgentDB", "Neural Trainer"],
                    nextAction: "Expand dashboard with all projects",
                    reasoning: "Portfolio intelligence system. 797 tests at 93% coverage. Fixed repo-scanner mocking, added neural-trainer skill. Production-ready CI/CD."
                },

                // ===== DORMANT PROJECTS (29) =====
                {
                    id: "algorithms_and_data_structures",
                    name: "algorithms_and_data_structures",
                    status: "green",
                    score: 95,
                    cluster: "Experience",
                    source: "human",
                    metrics: { commits: 0, tests: 0, coverage: 0 },
                    lastCommit: "2025-11-23",
                    techStack: ["TypeScript", "Algorithms"],
                    nextAction: "Add more algorithm implementations",
                    reasoning: "Algorithm reference implementations. Merge conflicts resolved. Ready for new algorithm additions."
                },
                {
                    id: "brandonjplambert",
                    name: "brandonjplambert",
                    status: "green",
                    score: 95,
                    cluster: "Core Systems",
                    source: "human",
                    metrics: { commits: 0, tests: 0, coverage: 0 },
                    lastCommit: "2025-12-02",
                    techStack: ["Portfolio", "AI Agent Planning"],
                    nextAction: "Implement AI agent v2 architecture",
                    reasoning: "Personal portfolio with AI agent planning docs. Queen orchestration plan (16K+ words), GOAP execution plan with 24 actions. Ready for implementation."
                },
                {
                    id: "close_reading",
                    name: "close_reading",
                    status: "green",
                    score: 95,
                    cluster: "Experience",
                    source: "robot",
                    metrics: { commits: 0, tests: 0, coverage: 0 },
                    lastCommit: "2025-12-02",
                    techStack: ["TypeScript", "Chakra UI", "Vercel"],
                    nextAction: "Add more reading comprehension features",
                    reasoning: "Educational reading comprehension app. TypeScript build errors resolved. Production-ready for Vercel deployment."
                },
                {
                    id: "cocinas_aprendes",
                    name: "cocinas_aprendes",
                    status: "green",
                    score: 95,
                    cluster: "Experience",
                    source: "human",
                    metrics: { commits: 0, tests: 0, coverage: 0 },
                    lastCommit: "2025-11-23",
                    techStack: ["React", "Spanish Learning"],
                    nextAction: "Add more cooking vocabulary",
                    reasoning: "Spanish cooking vocabulary app. LICENSE added, README enhanced for portfolio presentation."
                },
                {
                    id: "colores",
                    name: "colores",
                    status: "green",
                    score: 95,
                    cluster: "Experience",
                    source: "human",
                    metrics: { commits: 0, tests: 0, coverage: 0 },
                    lastCommit: "2025-11-23",
                    techStack: ["React", "Spanish Learning"],
                    nextAction: "Expand color exercises",
                    reasoning: "Spanish colors learning app. Professional README, 20+ emojis removed. Portfolio-ready."
                },
                {
                    id: "conjugation_gui",
                    name: "conjugation_gui",
                    status: "green",
                    score: 95,
                    cluster: "Experience",
                    source: "human",
                    metrics: { commits: 0, tests: 0, coverage: 0 },
                    lastCommit: "2025-11-23",
                    techStack: ["Python", "GUI", "Spanish Verbs"],
                    nextAction: "Add more verb tenses",
                    reasoning: "Spanish verb conjugation practice GUI. Merge completed successfully."
                },
                {
                    id: "corporate_intel",
                    name: "corporate_intel",
                    status: "green",
                    score: 95,
                    cluster: "Experience",
                    source: "human",
                    metrics: { commits: 0, tests: 0, coverage: 0 },
                    lastCommit: "2025-11-23",
                    techStack: ["Intelligence", "Analysis"],
                    nextAction: "Update documentation paths",
                    reasoning: "Corporate intelligence analysis tool. Documentation references updated after reorganization."
                },
                {
                    id: "cuerpo_humano",
                    name: "cuerpo_humano",
                    status: "green",
                    score: 95,
                    cluster: "Experience",
                    source: "human",
                    metrics: { commits: 0, tests: 0, coverage: 0 },
                    lastCommit: "2025-11-23",
                    techStack: ["React", "Spanish Learning", "Anatomy"],
                    nextAction: "Add more body parts vocabulary",
                    reasoning: "Human body Spanish vocabulary app. LICENSE added, technical overview expanded."
                },
                {
                    id: "fancy_monkey",
                    name: "fancy_monkey",
                    status: "green",
                    score: 95,
                    cluster: "Experience",
                    source: "human",
                    metrics: { commits: 0, tests: 0, coverage: 0 },
                    lastCommit: "2025-11-23",
                    techStack: ["React", "Game"],
                    nextAction: "Add game features",
                    reasoning: "Game project with technical architecture focus. Portfolio-formatted README retained."
                },
                {
                    id: "formas_y_tamanos",
                    name: "formas_y_tamanos",
                    status: "green",
                    score: 95,
                    cluster: "Experience",
                    source: "human",
                    metrics: { commits: 0, tests: 0, coverage: 0 },
                    lastCommit: "2025-11-23",
                    techStack: ["React", "3D Visualization", "Spanish"],
                    nextAction: "Enhance 3D shape interactions",
                    reasoning: "Shapes and sizes Spanish learning with 3D visualization. Portfolio-ready documentation."
                },
                {
                    id: "internet",
                    name: "internet",
                    status: "green",
                    score: 95,
                    cluster: "Experience",
                    source: "human",
                    metrics: { commits: 0, tests: 0, coverage: 0 },
                    lastCommit: "2025-11-23",
                    techStack: ["Educational"],
                    nextAction: "Add more networking concepts",
                    reasoning: "Internet concepts educational resource. MIT LICENSE added for portfolio."
                },
                {
                    id: "lab_visualizer",
                    name: "lab_visualizer",
                    status: "green",
                    score: 95,
                    cluster: "Experience",
                    source: "human",
                    metrics: { commits: 0, tests: 0, coverage: 0 },
                    lastCommit: "2025-11-24",
                    techStack: ["Visualization", "Lab Data"],
                    nextAction: "Add more visualization types",
                    reasoning: "Lab data visualization tool. Visual UI guide added for interactive features."
                },
                {
                    id: "learning_voice_agent",
                    name: "learning_voice_agent",
                    status: "green",
                    score: 95,
                    cluster: "Core Systems",
                    source: "robot",
                    metrics: { commits: 0, tests: 279, coverage: 0 },
                    lastCommit: "2025-12-01",
                    techStack: ["Python", "RuVector", "Voice AI"],
                    nextAction: "Deploy voice agent to production",
                    reasoning: "Voice AI with RuVector integration. 4-phase implementation: vector store, knowledge graph, learning integration, semantic routing. 279 tests passing."
                },
                {
                    id: "learn_my_system",
                    name: "learn_my_system",
                    status: "green",
                    score: 95,
                    cluster: "Core Systems",
                    source: "robot",
                    metrics: { commits: 0, tests: 0, coverage: 0 },
                    lastCommit: "2025-11-23",
                    techStack: ["System Learning", "Documentation"],
                    nextAction: "Add system exploration features",
                    reasoning: "System learning tool. Documentation reorganized with standard structure."
                },
                {
                    id: "learn_strudel",
                    name: "learn_strudel",
                    status: "green",
                    score: 95,
                    cluster: "Core Systems",
                    source: "robot",
                    metrics: { commits: 0, tests: 0, coverage: 0 },
                    lastCommit: "2025-11-23",
                    techStack: ["Strudel", "Music Coding"],
                    nextAction: "Add Strudel pattern examples",
                    reasoning: "Strudel live coding music tool. Standard documentation structure created."
                },
                {
                    id: "letratos",
                    name: "letratos",
                    status: "green",
                    score: 95,
                    cluster: "Core Systems",
                    source: "robot",
                    metrics: { commits: 0, tests: 0, coverage: 0 },
                    lastCommit: "2025-11-23",
                    techStack: ["Letters", "Spanish"],
                    nextAction: "Add more letter exercises",
                    reasoning: "Spanish letters learning app. CONTRIBUTING.md and SECURITY.md moved to docs/guides/."
                },
                {
                    id: "llms_on_my_system",
                    name: "llms_on_my_system",
                    status: "green",
                    score: 95,
                    cluster: "Core Systems",
                    source: "robot",
                    metrics: { commits: 0, tests: 0, coverage: 0 },
                    lastCommit: "2025-11-23",
                    techStack: ["LLM", "Local AI", "Setup Guide"],
                    nextAction: "Update for latest LLM releases",
                    reasoning: "Local LLM setup documentation. Guides consolidated in docs/guides/."
                },
                {
                    id: "meal_assistant",
                    name: "meal_assistant",
                    status: "green",
                    score: 95,
                    cluster: "Core Systems",
                    source: "robot",
                    metrics: { commits: 0, tests: 0, coverage: 0 },
                    lastCommit: "2025-12-01",
                    techStack: ["Node.js", "Railway", "PostgreSQL", "Redis"],
                    nextAction: "Configure production environment variables",
                    reasoning: "Meal planning assistant with Railway deployment. Dockerfile-based builds, health checks configured. PostgreSQL and Redis plugins ready."
                },
                {
                    id: "mundo",
                    name: "mundo",
                    status: "green",
                    score: 95,
                    cluster: "Experience",
                    source: "human",
                    metrics: { commits: 0, tests: 0, coverage: 0 },
                    lastCommit: "2025-11-23",
                    techStack: ["React", "Spanish", "Geography"],
                    nextAction: "Add more world regions",
                    reasoning: "World geography Spanish app. Portfolio-ready with LICENSE added."
                },
                {
                    id: "online_language_learning_resources",
                    name: "online_language_learning_resources",
                    status: "green",
                    score: 95,
                    cluster: "Experience",
                    source: "human",
                    metrics: { commits: 0, tests: 0, coverage: 0 },
                    lastCommit: "2025-11-23",
                    techStack: ["Resource Collection"],
                    nextAction: "Update resource links",
                    reasoning: "Curated language learning resources. Main branch merged and updated."
                },
                {
                    id: "open_learn",
                    name: "open_learn",
                    status: "green",
                    score: 95,
                    cluster: "Experience",
                    source: "human",
                    metrics: { commits: 0, tests: 0, coverage: 0 },
                    lastCommit: "2025-11-23",
                    techStack: ["Learning Platform"],
                    nextAction: "Add more courses",
                    reasoning: "Open learning platform. Portfolio-ready with professional formatting."
                },
                {
                    id: "planetas",
                    name: "planetas",
                    status: "green",
                    score: 95,
                    cluster: "Experience",
                    source: "human",
                    metrics: { commits: 0, tests: 0, coverage: 0 },
                    lastCommit: "2025-11-23",
                    techStack: ["React", "Spanish", "Space"],
                    nextAction: "Add more planet details",
                    reasoning: "Planets Spanish vocabulary app. LICENSE added, emoji overuse removed."
                },
                {
                    id: "report_assistant",
                    name: "report_assistant",
                    status: "green",
                    score: 95,
                    cluster: "Experience",
                    source: "human",
                    metrics: { commits: 0, tests: 0, coverage: 0 },
                    lastCommit: "2025-11-23",
                    techStack: ["Report Generation"],
                    nextAction: "Add more report templates",
                    reasoning: "Report generation assistant. Documentation references updated after reorganization."
                },
                {
                    id: "sec_latent",
                    name: "sec_latent",
                    status: "green",
                    score: 95,
                    cluster: "Experience",
                    source: "human",
                    metrics: { commits: 0, tests: 0, coverage: 0 },
                    lastCommit: "2025-11-23",
                    techStack: ["Security", "Latent Analysis"],
                    nextAction: "Add security analysis features",
                    reasoning: "Security latent analysis tool. Portfolio-ready documentation."
                },
                {
                    id: "sinonimos",
                    name: "sinonimos",
                    status: "green",
                    score: 95,
                    cluster: "Experience",
                    source: "human",
                    metrics: { commits: 0, tests: 0, coverage: 0 },
                    lastCommit: "2025-11-17",
                    techStack: ["Spanish", "Synonyms", "Deployment"],
                    nextAction: "Add more synonym sets",
                    reasoning: "Spanish synonyms app with deployment guide and success modal. Platform-specific guides for GitHub Pages, Netlify, Vercel."
                },
                {
                    id: "sinonimos_de_caminar",
                    name: "sinonimos_de_caminar",
                    status: "green",
                    score: 95,
                    cluster: "Experience",
                    source: "robot",
                    metrics: { commits: 0, tests: 0, coverage: 0 },
                    lastCommit: "2025-11-11",
                    techStack: ["Spanish", "Walking Verbs"],
                    nextAction: "Add audio pronunciations",
                    reasoning: "Walking synonyms Spanish app. README updated with current project status."
                },
                {
                    id: "sinonimos_de_hablar",
                    name: "sinonimos_de_hablar",
                    status: "green",
                    score: 95,
                    cluster: "Experience",
                    source: "robot",
                    metrics: { commits: 0, tests: 0, coverage: 0 },
                    lastCommit: "2025-11-11",
                    techStack: ["Spanish", "Speaking Verbs"],
                    nextAction: "Add audio pronunciations",
                    reasoning: "Speaking synonyms Spanish app. README updated with current project status."
                },
                {
                    id: "subjunctive_practice",
                    name: "subjunctive_practice",
                    status: "green",
                    score: 95,
                    cluster: "Experience",
                    source: "human",
                    metrics: { commits: 0, tests: 0, coverage: 0 },
                    lastCommit: "2025-12-02",
                    techStack: ["Spanish", "Grammar", "Subjunctive"],
                    nextAction: "Add more subjunctive exercises",
                    reasoning: "Spanish subjunctive practice app. Origin/master merged into main for production release."
                },
                {
                    id: "video_gen",
                    name: "video_gen",
                    status: "green",
                    score: 95,
                    cluster: "Core Systems",
                    source: "robot",
                    metrics: { commits: 0, tests: 0, coverage: 79 },
                    lastCommit: "2025-12-02",
                    techStack: ["Python", "Video Generation", "AI Narration"],
                    nextAction: "Optimize video rendering pipeline",
                    reasoning: "Professional video generation with 79% test coverage. SSE progress tracking enhanced, jobs error display improved. Production-ready with Sonnet 4.5 narration."
                }
            ],
            clusters: [
                {
                    name: "Experience",
                    color: "#3b82f6",
                    description: "UI/UX, Games, Education, Language Learning (24 projects)"
                },
                {
                    name: "Core Systems",
                    color: "#10b981",
                    description: "APIs, Backend, AI Integration (12 projects)"
                },
                {
                    name: "Infra",
                    color: "#f59e0b",
                    description: "DevOps, CI/CD, Orchestration (1 project)"
                }
            ]
        };

        // Components

        // HeatmapNode - Small interactive square
        const HeatmapNode = ({ status, project, onClick }) => {
            const colors = {
                green: 'bg-green-500 hover:bg-green-400',
                yellow: 'bg-yellow-500 hover:bg-yellow-400',
                red: 'bg-red-500 hover:bg-red-400'
            };

            return (
                <div
                    className={`heatmap-node w-8 h-8 rounded cursor-pointer ${colors[status]}`}
                    title={`${project.name} (${project.score})`}
                    onClick={() => onClick(project)}
                />
            );
        };

        // SourceIcon - Attribution badge
        const SourceIcon = ({ type }) => {
            return (
                <div className={`inline-flex items-center px-2 py-1 rounded-full text-xs ${
                    type === 'robot'
                        ? 'bg-purple-900/50 text-purple-300 border border-purple-700'
                        : 'bg-blue-900/50 text-blue-300 border border-blue-700'
                }`}>
                    {type === 'robot' ? <RobotIcon /> : <UserIcon />}
                    <span className="ml-1">{type === 'robot' ? 'AI' : 'Human'}</span>
                </div>
            );
        };

        // ContextCard - Flip card with metrics and reasoning
        const ContextCard = ({ project }) => {
            const statusColors = {
                green: 'border-green-500',
                yellow: 'border-yellow-500',
                red: 'border-red-500'
            };

            return (
                <div className="flip-card h-64">
                    <div className="flip-card-inner">
                        {/* Front - Metrics */}
                        <div className={`flip-card-front bg-slate-800 border-2 ${statusColors[project.status]} p-6`}>
                            <div className="flex justify-between items-start mb-4">
                                <h3 className="text-lg font-bold text-slate-100">{project.name}</h3>
                                <SourceIcon type={project.source} />
                            </div>

                            <div className="space-y-3">
                                <div className="flex justify-between items-center">
                                    <span className="text-slate-400">Alignment Score</span>
                                    <span className="text-2xl font-bold">{project.score}%</span>
                                </div>

                                <div className="space-y-2">
                                    <div className="flex justify-between text-sm">
                                        <span className="text-slate-400">Commits</span>
                                        <span className="text-slate-200">{project.metrics.commits}</span>
                                    </div>
                                    <div className="flex justify-between text-sm">
                                        <span className="text-slate-400">Tests</span>
                                        <span className="text-slate-200">{project.metrics.tests}</span>
                                    </div>
                                    <div className="flex justify-between text-sm">
                                        <span className="text-slate-400">Coverage</span>
                                        <span className="text-slate-200">{project.metrics.coverage}%</span>
                                    </div>
                                </div>
                            </div>

                            <div className="mt-4 text-xs text-slate-500 text-center">
                                Hover for AgentDB reasoning
                            </div>
                        </div>

                        {/* Back - Reasoning */}
                        <div className={`flip-card-back bg-slate-700 border-2 ${statusColors[project.status]} p-6`}>
                            <div className="flex items-start mb-3">
                                <div className="text-2xl mr-2">üß†</div>
                                <h3 className="text-sm font-bold text-slate-100">AgentDB Analysis</h3>
                            </div>

                            <p className="text-sm text-slate-300 leading-relaxed">
                                {project.reasoning}
                            </p>

                            <div className="mt-4 pt-4 border-t border-slate-600">
                                <div className="text-xs text-slate-400">
                                    Cluster: <span className="text-slate-200">{project.cluster}</span>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            );
        };

        // ProgressRow - Table row for Ledger view
        const ProgressRow = ({ project }) => {
            const statusIcons = {
                green: <CheckIcon />,
                yellow: <TrendingUpIcon />,
                red: <AlertIcon />
            };

            const statusColors = {
                green: 'text-green-400',
                yellow: 'text-yellow-400',
                red: 'text-red-400'
            };

            return (
                <tr className="border-b border-slate-700 hover:bg-slate-800/50">
                    <td className="px-4 py-3">
                        <div className="flex items-center gap-2">
                            <span className={statusColors[project.status]}>
                                {statusIcons[project.status]}
                            </span>
                            <span className="font-medium">{project.name}</span>
                        </div>
                    </td>
                    <td className="px-4 py-3">
                        <SourceIcon type={project.source} />
                    </td>
                    <td className="px-4 py-3">
                        <span className="text-slate-300">{project.cluster}</span>
                    </td>
                    <td className="px-4 py-3">
                        <div className="flex items-center gap-2">
                            <div className="w-32 bg-slate-700 rounded-full h-2">
                                <div
                                    className={`h-2 rounded-full ${
                                        project.status === 'green' ? 'bg-green-500' :
                                        project.status === 'yellow' ? 'bg-yellow-500' :
                                        'bg-red-500'
                                    }`}
                                    style={{ width: `${project.score}%` }}
                                />
                            </div>
                            <span className="text-sm font-bold">{project.score}%</span>
                        </div>
                    </td>
                    <td className="px-4 py-3 text-sm text-slate-400">
                        {project.metrics.commits} commits
                    </td>
                    <td className="px-4 py-3 text-sm text-slate-400">
                        {project.metrics.coverage}% coverage
                    </td>
                </tr>
            );
        };

        // ClusterSection - Swimlane for each cluster
        const ClusterSection = ({ cluster, projects }) => {
            return (
                <div className="mb-8">
                    <div className="flex items-center gap-3 mb-4">
                        <div
                            className="w-4 h-4 rounded"
                            style={{ backgroundColor: cluster.color }}
                        />
                        <h2 className="text-2xl font-bold">{cluster.name}</h2>
                        <span className="text-slate-400">({projects.length} projects)</span>
                    </div>

                    <p className="text-slate-400 mb-6">{cluster.description}</p>

                    <div className="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-4">
                        {projects.map(project => (
                            <ContextCard key={project.id} project={project} />
                        ))}
                    </div>
                </div>
            );
        };

        // Main Dashboard Component
        const Dashboard = () => {
            const [data, setData] = useState(initialData);
            const [view, setView] = useState('clusters'); // 'clusters' or 'ledger'
            const [selectedProject, setSelectedProject] = useState(null);

            const handleHeatmapClick = (project) => {
                setSelectedProject(project);
            };

            const getProjectsByCluster = (clusterName) => {
                return data.projects.filter(p => p.cluster === clusterName);
            };

            const statusCounts = {
                green: data.projects.filter(p => p.status === 'green').length,
                yellow: data.projects.filter(p => p.status === 'yellow').length,
                red: data.projects.filter(p => p.status === 'red').length
            };

            return (
                <div className="min-h-screen bg-slate-900 p-6">
                    {/* Header */}
                    <div className="max-w-7xl mx-auto mb-8">
                        <div className="flex justify-between items-start mb-6">
                            <div>
                                <h1 className="text-4xl font-bold mb-2">
                                    Portfolio Cognitive Command <span className="text-purple-400">v8.0</span>
                                </h1>
                                <p className="text-slate-400">
                                    Last scan: {new Date(data.meta.lastScan).toLocaleString()}
                                </p>
                            </div>

                            <div className="text-right">
                                <div className="text-3xl font-bold text-purple-400">
                                    {data.meta.precision}%
                                </div>
                                <div className="text-sm text-slate-400">Precision Score</div>
                            </div>
                        </div>

                        {/* Meta Stats */}
                        <div className="grid grid-cols-1 md:grid-cols-4 gap-4 mb-8">
                            <div className="bg-slate-800 rounded-lg p-4 border border-slate-700">
                                <div className="text-2xl font-bold text-green-400">{data.meta.active}</div>
                                <div className="text-sm text-slate-400">Active Projects</div>
                            </div>
                            <div className="bg-slate-800 rounded-lg p-4 border border-slate-700">
                                <div className="text-2xl font-bold text-yellow-400">{data.meta.dormant}</div>
                                <div className="text-sm text-slate-400">Dormant Projects</div>
                            </div>
                            <div className="bg-slate-800 rounded-lg p-4 border border-slate-700">
                                <div className="text-2xl font-bold text-slate-300">{data.meta.total}</div>
                                <div className="text-sm text-slate-400">Total Projects</div>
                            </div>
                            <div className="bg-slate-800 rounded-lg p-4 border border-slate-700">
                                <div className="flex gap-2 items-center justify-center">
                                    <div className="text-center">
                                        <div className="text-sm font-bold text-green-400">{statusCounts.green}</div>
                                        <div className="text-xs text-slate-500">Aligned</div>
                                    </div>
                                    <div className="text-center">
                                        <div className="text-sm font-bold text-yellow-400">{statusCounts.yellow}</div>
                                        <div className="text-xs text-slate-500">Moderate</div>
                                    </div>
                                    <div className="text-center">
                                        <div className="text-sm font-bold text-red-400">{statusCounts.red}</div>
                                        <div className="text-xs text-slate-500">Drift</div>
                                    </div>
                                </div>
                            </div>
                        </div>

                        {/* Portfolio Heatmap */}
                        <div className="bg-slate-800 rounded-lg p-6 border border-slate-700 mb-8">
                            <h2 className="text-xl font-bold mb-4">Portfolio Heatmap</h2>
                            <div className="flex flex-wrap gap-2">
                                {data.projects.map(project => (
                                    <HeatmapNode
                                        key={project.id}
                                        status={project.status}
                                        project={project}
                                        onClick={handleHeatmapClick}
                                    />
                                ))}
                            </div>
                            <div className="mt-4 flex gap-4 text-sm text-slate-400">
                                <div className="flex items-center gap-2">
                                    <div className="w-4 h-4 bg-green-500 rounded"></div>
                                    <span>Aligned (&gt;80)</span>
                                </div>
                                <div className="flex items-center gap-2">
                                    <div className="w-4 h-4 bg-yellow-500 rounded"></div>
                                    <span>Moderate (50-80)</span>
                                </div>
                                <div className="flex items-center gap-2">
                                    <div className="w-4 h-4 bg-red-500 rounded"></div>
                                    <span>Drift (&lt;50)</span>
                                </div>
                            </div>
                        </div>

                        {/* View Switcher */}
                        <div className="flex gap-2 mb-6">
                            <button
                                onClick={() => setView('clusters')}
                                className={`px-4 py-2 rounded-lg font-medium transition ${
                                    view === 'clusters'
                                        ? 'bg-purple-600 text-white'
                                        : 'bg-slate-800 text-slate-400 hover:bg-slate-700'
                                }`}
                            >
                                Cluster View
                            </button>
                            <button
                                onClick={() => setView('ledger')}
                                className={`px-4 py-2 rounded-lg font-medium transition ${
                                    view === 'ledger'
                                        ? 'bg-purple-600 text-white'
                                        : 'bg-slate-800 text-slate-400 hover:bg-slate-700'
                                }`}
                            >
                                Ledger View
                            </button>
                        </div>

                        {/* Cluster View */}
                        {view === 'clusters' && (
                            <div>
                                {data.clusters.map(cluster => (
                                    <ClusterSection
                                        key={cluster.name}
                                        cluster={cluster}
                                        projects={getProjectsByCluster(cluster.name)}
                                    />
                                ))}
                            </div>
                        )}

                        {/* Ledger View */}
                        {view === 'ledger' && (
                            <div className="bg-slate-800 rounded-lg border border-slate-700 overflow-hidden">
                                <table className="w-full">
                                    <thead className="bg-slate-700">
                                        <tr>
                                            <th className="px-4 py-3 text-left text-sm font-semibold">Project</th>
                                            <th className="px-4 py-3 text-left text-sm font-semibold">Source</th>
                                            <th className="px-4 py-3 text-left text-sm font-semibold">Cluster</th>
                                            <th className="px-4 py-3 text-left text-sm font-semibold">Alignment</th>
                                            <th className="px-4 py-3 text-left text-sm font-semibold">Activity</th>
                                            <th className="px-4 py-3 text-left text-sm font-semibold">Coverage</th>
                                        </tr>
                                    </thead>
                                    <tbody>
                                        {data.projects.map(project => (
                                            <ProgressRow key={project.id} project={project} />
                                        ))}
                                    </tbody>
                                </table>
                            </div>
                        )}
                    </div>

                    {/* Selected Project Modal */}
                    {selectedProject && (
                        <div
                            className="fixed inset-0 bg-black/50 flex items-center justify-center p-4 z-50"
                            onClick={() => setSelectedProject(null)}
                        >
                            <div
                                className="bg-slate-800 rounded-lg p-6 max-w-md w-full border-2 border-purple-500"
                                onClick={e => e.stopPropagation()}
                            >
                                <div className="flex justify-between items-start mb-4">
                                    <h3 className="text-xl font-bold">{selectedProject.name}</h3>
                                    <button
                                        onClick={() => setSelectedProject(null)}
                                        className="text-slate-400 hover:text-slate-200"
                                    >
                                        ‚úï
                                    </button>
                                </div>
                                <ContextCard project={selectedProject} />
                            </div>
                        </div>
                    )}
                </div>
            );
        };

        // Render
        const root = ReactDOM.createRoot(document.getElementById('root'));
        root.render(<Dashboard />);
    </script>
</body>
</html>